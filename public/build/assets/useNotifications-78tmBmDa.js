import{x as r,A as g}from"./app-CekrNlUD.js";const t=g({counts:{},totalUnread:0});function h(){try{const n=localStorage.getItem("chat_notifications");if(n){const e=JSON.parse(n);t.counts=e,c()}}catch(n){console.error("Error loading notifications:",n)}}function a(){try{localStorage.setItem("chat_notifications",JSON.stringify(t.counts))}catch(n){console.error("Error saving notifications:",n)}}function c(){t.totalUnread=Object.values(t.counts).reduce((n,e)=>n+e,0)}h();function v(){const n=o=>{t.counts[o]||(t.counts[o]=0),t.counts[o]++,c(),a()},e=o=>{t.counts[o]&&(t.counts[o]=0,c(),a())},l=o=>{t.counts[o]&&(delete t.counts[o],c(),a())},u=o=>t.counts[o]||0,f=()=>{t.counts={},t.totalUnread=0,a()},d=()=>{if(window.Echo){const o=window.Laravel?.user?.id;if(o){const i=`chat.${o}`;return window.Echo.private(i).listen(".MessageSent",s=>{s.message&&s.message.sender_id!==o&&n(s.message.sender_id)}),()=>{window.Echo.leave(i)}}}return()=>{}};return{notifications:r(()=>t.counts),totalUnread:r(()=>t.totalUnread),addNotification:n,markAsRead:e,clearNotifications:l,getNotificationCount:u,clearAllNotifications:f,setupGlobalListener:d}}export{v as u};
